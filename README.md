# segScan
Cooperative group on segScan
# Warning
Change the directory of datasets, names to your own path
# Run
Go to `test-cg/src`.
To do the checking
```
make clean TARGET=check
make TARGET=check
./run.sh
```
To do the testing
```
make clean TARGET=test
make TARGET=test
./run.sh
```
# Observation
1. Cooperative group doesn't necessarily improve the performance (7_6_1_36.csv, 7_7_3_34.csv)

| Dataset     | Macro | Cooperative Group |
| :---:       |    :----:   |    :---: |
| 192bit      | 25.9552 ms  | 28.8416 ms  |
| 12month1    | 2588.6400 ms| 2386.9184 ms|

2. Optimal area instead of point (7_7_3_40.csv, 7_7_5_50.csv)
Execution time difference is with in 0.5%

| Optimal block_factor | Execution Time |
| ----------- | ----------- |
| 1/16 | 2332.5920 ms |
| 1 | 2345.6064 ms |

3. The optimal area depends on datasets (7_7_1_12.csv, 7_7_3_40.csv)

| Dataset     | group_factor | tail_factor | thread_per_block | block_factor|
| ----------- | ----------- | ----------- | ----------- | ----------- |
| 192bit      |     2       |       2     | 256 | (1/2,2) |
| 12month1    |     4       |       5     | 128 | (1/16,1)|

4. Results of acceleration brought by tuning

ebpr

| Hardware | mean | std | geomean | max | N | 
| :---:    | :----:| :---:| :---:| :---:|:---:| 
| 3090 | 1.520 | 0.322 | 1.490 | 2.950 | 128 |
| 2080 | 1.254 | 0.196 | 1.240 | 2.159 | 128 |
| V100 | 1.565 | 0.464 | 1.505 | 3.519 | 128 |
| 3090 | 1.476 | 0.301 | 1.449 | 2.890 | 64 |
| 2080 | 1.245 | 0.193 | 1.232 | 2.090 | 64 |
| V100 | 1.524 | 0.439 | 1.469 | 3.398 | 64 |
| 3090 | 1.050 | 0.071 | 1.048 | 1.557 | 16 |
| 2080 | 1.033 | 0.045 | 1.032 | 1.413 | 16 |
| V100 | 1.042 | 0.056 | 1.040 | 1.511 | 16 |
| 3090 | 1.111 | 0.139 | 1.103 | 1.769 | 4 |
| 2080 | 1.047 | 0.059 | 1.045 | 1.387 | 4 |
| V100 | 1.090 | 0.127 | 1.084 | 1.732 | 4 |


rbpr

| Hardware | mean | std | geomean | max | N | 
| :---:| :----:| :---:| :---:| :---:|  :---:| 
| 3090 | 2.464 | 0.879 | 2.295 | 4.316 | 128 |
| 2080 | 2.036 | 0.638 | 1.938 | 4.379 | 128 |
| V100 | 1.966 | 0.606 | 1.874 | 3.724 | 128 |
| 3090 | 2.354 | 0.882 | 2.181 | 4.432 | 64  |
| 2080 | 2.043 | 0.704 | 1.927 | 4.430 | 64  |
| V100 | 1.925 | 0.628 | 1.824 | 3.846 | 64  |
| 3090 | 2.158 | 0.813 | 1.997 | 4.271 | 16 |
| 2080 | 2.180 | 0.937 | 1.995 | 5.019 | 16 | 
| V100 | 1.786 | 0.583 | 1.693 | 3.388 | 16 |
| 3090 | 2.416 | 1.498 | 2.046 | 7.819 | 4 |
| 2080 | 2.738 | 1.666 | 2.307 | 8.582 | 4 |
| V100 | 2.108 | 1.154 | 1.852 | 6.114 | 4 | 

ebsr

| Hardware | mean | std | geomean | max | N | 
| :---:    | :----:| :---:| :---:| :---:|  :---:| 
| 3090 | 1.470 | 0.349 | 1.432 | 2.239 | 64 |
| 2080 | 1.675 | 0.236 | 1.658 | 2.290 | 64 |
| V100 | 1.503 | 0.224 | 1.487 | 2.097 | 64 |
| 3090 | 1.511 | 0.262 | 1.489 | 2.240 | 16 |
| 2080 | 1.549 | 0.169 | 1.540 | 2.186 | 16 |
| V100 | 1.441 | 0.221 | 1.425 | 2.191 | 16 |
| 3090 | 2.080 | 0.359 | 2.046 | 2.880 | 4  |
| 2080 | 2.137 | 0.268 | 2.119 | 2.722 | 4  |
| V100 | 2.026 | 0.366 | 1.991 | 2.735 | 4  | 

rbsr 
| Hardware | mean | std | geomean | max | N | 
| :---:    | :----:| :---:| :---:| :---:|  :---:| 
| 3090 | 1.011 | 0.040 | 1.010 | 1.394 | 4 |
| 2080 | 1.014 | 0.058 | 1.013 | 1.664 | 4 |
| V100 | 1.002 | 0.015 | 1.002 | 1.264 | 4 |



5. Best result vs. cuSPARSE

ebpr

| Hardware | mean | std | geomean | max | faster | N | 
| :---:    | :----:| :---:| :---:| :---:| :---:| :---:| 
| 3090 | 0.371 | 0.151 | 0.342 | 1.394| cop20k_A | 128 |
| 2080 | 0.292 | 0.130 | 0.263 | 0.881| none | 128 |
| V100 | 0.314 | 0.122 | 0.295 | 2.022| cop20k_A | 128 |
| 3090 | 0.396 | 0.161 | 0.371 | 2.451| cop20k_A | 64 |
| 2080 | 0.319 | 0.111 | 0.303 | 1.473| cop20k_A | 64 |
| V100 | 0.420 | 0.182 | 0.397 | 3.758 |(NotreDame_www,1.583),  (cop20k_A,3.758) | 64 |
| 3090 | 1.103 | 0.408 | 1.068 | 9.474 | 401 | 16 |
| 2080 | 0.950 | 0.291 | 0.922 | 5.884 | 278 | 16 |
| V100 | 1.214 | 0.589 | 1.165 | 14.46 | 518 | 16 |
| 3090 | 3.208 | 1.251 | 3.123 | 31.75 | 740 | 4 |
| 2080 | 2.707 | 0.836 | 2.643 | 19.37 | 740 | 4 |
| V100 | 3.143 | 1.778 | 3.016 | 45.23 | 740 | 4 |

rbpr

| Hardware | mean | std | geomean | max | faster| N | 
| :---:    | :----:| :---:| :---:| :---:| :---:| :---:| 
| 3090 | 0.525 | 0.155 | 0.499 | 2.256 | cop20k_A | 128 |
| 2080 | 0.336 | 0.083 | 0.327 | 1.130 | cop20k_A | 128 |
| V100 | 0.391 | 0.133 | 0.374 | 2.682 | cop20k_A | 128 |
| 3090 | 0.554 | 0.202 | 0.520 | 3.633 | (cop20k_A,3.633),(NotreDame_www,1.108),(pkustk02,1.048),(shuttle_eddy,1.008),(ted_B_unscaled,1.012) | 64 |
| 2080 | 0.382 | 0.101 | 0.371 | 1.969 | cop20k_A | 64 |
| V100 | 0.525 | 0.229 | 0.494 | 4.981 | (cop20k_A,4.981),(NotreDame_www,1.309),(pkustk02,1.044),(shuttle_eddy,1.035) | 64 |
| 3090 | 1.660 | 0.887 | 1.470 | 17.02 | 602 | 16 |
| 2080 | 1.255 | 0.498 | 1.162 | 8.206 | 525 | 16 |
| V100 | 1.554 | 0.844 | 1.406 | 18.73 | 607 | 16 |
| 3090 | 5.251 | 3.280 | 4.150 | 61.80 | 685 | 4 |
| 2080 | 4.566 | 2.328 | 3.861 | 38.039 | 694 | 4 |
| V100 | 4.854 | 3.691 | 3.922 | 86.353 | 688 | 4 |

ebsr

| Hardware | mean | std | geomean | max | faster| N |
| :---:    | :----:| :---:| :---:| :---:| :---:| :---:|  
| 3090 | 1.370 | 0.429 | 1.343 | 11.157 | 737 | 64 |
| 2080 | 1.226 | 0.259 | 1.212 | 6.804 | 696 | 64 |
| V100 | 1.432 | 0.546 | 1.400 | 14.384 | 730 | 64 |
| 3090 | 2.244 | 0.882 | 2.181 | 23.147 | 740 | 16 |
| 2080 | 1.899 | 0.474 | 1.871 | 12.375 | 740 | 16 |
| V100 | 2.300 | 1.115 | 2.218 | 29.566 | 740 | 16 |
| 3090 | 3.281 | 1.287 | 3.188 | 32.356 | 738 | 4 |
| 2080 | 2.919 | 0.906 | 2.851 | 22.108 | 738 | 4 |
| V100 | 3.479 | 1.976 | 3.341 | 50.998 | 738 | 4 |

rbsr 
| Hardware | mean | std | geomean | max | faster| N |
| :---:    | :----:| :---:| :---:| :---:| :---:| :---:|  
| 3090 | 4.912 | 3.662 | 3.000 | 63.05 | 618 | 4 |
| 2080 | 4.329 | 2.583 | 3.149 | 37.63 | 648 | 4 |
| V100 | 4.212 | 3.634 | 2.534 | 68.85 | 608 | 4 |




6. Dynamic vs. static

ebpr

| Hardware | mean | std | geomean | N | Best static |
| :---:    | :----:| :---:| :---:| :---:| :---:| 
| 3090 | 1.042/1.046 | 0.048/0.074 | 1.041/1.044 | 128 | (5,256,5,1,32/16) |
| 2080 | 1.028/1.025 | 0.057/0.052 | 1.026/1.024 | 128 | (5,256,5,1,32/16) |
| V100 | 1.029/1.030 | 0.043/0.049 | 1.028/1.029 | 128 | (5,256,5,1,32/16) |
| 3090 | 1.050 | 0.062 | 1.048 | 64 | (5,256,5,1,8) |
| 2080 | 1.034 | 0.052 | 1.033 | 64 | (5,256,5,1,16) |
| V100 | 1.030 | 0.037 | 1.029 | 64 | (5,256,5,1,16) |
| 3090 | 1.050 | 0.071 | 1.048 | 16 | (5,256,5,1,8) |
| 2080 | 1.034/1.033 | 0.050/0.045 | 1.033/1.032 | 16 | (5,256,5,1,16/8) |
| V100 | 1.042 | 0.056 | 1.040 | 16 | (5,256,5,1,8) |
| 3090 | 1.061 | 0.072 | 1.059 | 4 | (5,256,5,1,4) |
| 2080 | 1.051 | 0.050 | 1.050 | 4 | (5,256,5,1,4) |
| V100 | 1.055 | 0.074 | 1.053 | 4 | (5,256,5,1,4) |

rbpr

| Hardware | mean | std | geomean | N | Best static |
| :---:    | :----:| :---:| :---:| :---:| :---:| 
| 3090 | 1.155 | 0.0356 | 1.124 | 128 | (3,256,3,1,2) |
| 2080 | 1.118 | 0.288  | 1.095 | 128 | (2,256,3,1,2) |
| V100 | 1.182 | 0.459  | 1.137 | 128 | (3,256,3,1,2) |
| 3090 | 1.210 | 0.544  | 1.152 | 64 | (3,256,3,1,2) |
| 2080 | 1.142 | 0.325 | 1.114 | 64 | (2,256,3,1,2) |
| V100 | 1.246 | 0.565 | 1.177 | 64 | (3,256,3,1,2) |
| 3090 | 1.530 | 1.287 | 1.310 | 16 | (3,256,3,1,2) |
| 2080 | 1.361 | 0.657 | 1.276 | 16 | (2,256,3,1,2) |
| V100 | 1.541 | 1.036 | 1.367 | 16 | (3,256,3,1,1) |
| 3090 | 1.546 | 0.803 | 1.406 | 4 | (3,256,3,1,1) |
| 2080 | 1.392 | 0.595 | 1.310 | 4 | (2,256,3,1,2) |
| V100 | 1.442 | 0.709 | 1.326 | 4 | (3,256,3,1,1) |

ebsr

| Hardware | mean | std | geomean | N | Best static |
| :---:    | :----:| :---:| :---:| :---:| :---:| 
| 3090 | 1.075/1.066 | 0.083/0.075  | 1.072/1.034 | 64 | (4,256,4,1,1,32/16) |
| 2080 | 1.035/1.036 | 0.050/0.049 | 1.034/1.034 | 64 | (4,256,4,1,1,32/16) |
| V100 | 1.041 | 0.058 | 1.040 | 64 | (4,256,4,1,1,16) |
| 3090 | 1.081 | 0.171 | 1.071 | 4 | (2,256,1,2,1,32) |
| 2080 | 1.023 | 0.070 | 1.021 | 4 | (2,256,1,2,1,32) |
| V100 | 1.097 | 0.177 | 1.086 | 4 | (2,256,1,2,1,32) |

